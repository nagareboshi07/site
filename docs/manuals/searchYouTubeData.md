# YouTubeData検索シート

## 概要
- YouTubeの動画の検索結果をシートに表示します。  
- 再生リスト関連の処理を実行します。  

---

## 目次
- [シートの説明](#シートの説明)
- [サポート中バージョン](#サポート中バージョン)
- [API検索](#api検索)
- [再生リスト追加](#再生リスト追加)
- [更新履歴](#更新履歴)

---

## シートの説明  
- API検索設定 シート  
  - APIで検索を行う際の設定を行うシート  
- 結果 シート  
  - 検索した結果が追加されるシート。  
- 表示 シート  
  - 結果シートの結果を整形し表示するシート。  
- ログ シート  
  - 実行時の動作記録を表示するシート。  
- その他機能・設定 シート  
  - 細々とした設定、及び補助的機能の設定シート。
- 再生リスト追加 シート
  - 指定した動画を再生リストに追加するためのシート。
<br>

---

## サポート中バージョン
### 最新バージョン
- ver.1.00  
  ※原則、最新バージョンを使用してください。

### サポート中バージョン（不具合対応のみ）
- 対象なし

### サポート終了バージョン  
- 対象なし

---

## API検索
### 留意事項  
- 一定時間あたりの実行制限（クォータ）があります。  
APIを使用するたびにコストを消費し、クォータ値を超過した場合、コストが回復するまで処理が実行できなくなります。  
クォータ制限に達したことによりエラーとなる場合は、時間を置いて再度実行してください。  
※1 処理の内容により、コストの消費量は異なります。  
※2 検索処理で使用したコストと再生リストの追加処理で使用したコストの合計値で扱われます。<br><br>

### 使用方法
#### 1. API検索設定シートを開く。
#### 2. 必要な情報を入力する。

- A. 検索キーワード  
  検索時に用いるキーワード
- B. 検索方法
  「キーワード検索」のみ指定可能  
- C. 検索設定  
  - キーワード検索  
    キーワードで検索を行った場合にヒットする動画を表示する。タイトル、説明文、投稿者が設定したタグ（非表示）など
  - タイトルに含む
    動画タイトルにキーワードを含む動画を表示する。
- D.検索指定  
  検索する上での制限範囲を設定する  
  指定可能なパラメータは、[YouTubeDataAPIv3 Search: list リファレンス](https://developers.google.com/youtube/v3/docs/search/list?hl=ja) 参照
- E. ハッシュタグ制限  
  説明文もしくはタイトルにハッシュタグを含む動画のみになるよう、フィルタリングする。
- F. 並び替え  
  結果の表示順を指定する  
- G. 最大数
  APIの実行1回毎の取得数を指定する。  
  特に理由がない場合は、50（最大値）。  
  ※ハッシュタグを指定している場合も、ハッシュタグの有無を確認する前の結果の取得数。  
- H. 検索実行回数  
  検索APIを実行する回数を指定する。  
  動画の取得件数は、ハッシュタグのフィルタ前で、「G.最大数 × H.検索実行回数」件となる。  
- I. 続きから：トークン  
  - 指定なし  
  毎回最初から検索する（既定）  
  - 続きから検索  
    - 前回検索した続きから検索する。（自動で記録される「ページトークン」の情報が必要）  

#### 3. 上部メニューの「拡張機能」→「マクロ」→「YouTube検索」をクリックする。  
※ 初回実行時は、GASのアクセス権の承認が必要です。  
<br>

---

## 再生リスト追加
### ★留意事項  
- 追加する先の再生リストの所有者は、スクリプトの実行者である必要があります。  
- 一定時間あたりの実行制限（クォータ）があります。  
APIを使用するたびにコストを消費し、クォータ値を超過した場合、コストが回復するまで処理が実行できなくなります。  
クォータ制限に達したことによりエラーとなる場合は、時間を置いて再度実行してください。  
※1 処理の内容により、コストの消費量は異なります。  
※2 検索処理で使用したコストと再生リストの追加処理で使用したコストの合計値で扱われます。<br><br>

### 使用方法
#### 1. 再生リスト追加 シートを開く。  
#### 2. 再生リストを作成し、IDを再生リストIDに追加する。  
※対象の再生リストを開き、URL内の「list={__XXXXXXXX__}」の__XXXXXXXX__が再生リストのIDです。  
#### 3. 動画の追加位置を指定する。  
#### 4. 「動画ID」を記入する。  
#### 5. 追加する対象の動画IDの行の「処理済」のチェックが外れていることを確認する。  
#### 6. 上部メニューの「拡張機能」→「マクロ」→「再生リストの動画追加」をクリックする。    
※ 初回実行時は、GASのアクセス権の承認が必要です。   
<br> 

---

## 更新履歴
※★付きのバージョンはサポート中です。
### ★ver.1.00(2022/06/10)
- 検索シートとして基本的な機能の実装。
- 再生リストへの動画追加処理の実装